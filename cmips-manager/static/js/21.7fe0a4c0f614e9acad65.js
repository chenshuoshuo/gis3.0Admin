webpackJsonp([21],{"0DZ6":function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,"\n.attr-building {\n  padding: 20px;\n}\n.attr-building .el-dialog__body {\n    padding-bottom: 0;\n}\n.attr-building .fixed-width .el-button--mini {\n    display: inline-block;\n    width: auto;\n}\n.attr-building .radio {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n}\n.attr-building .post-form .required .el-form-item__content::after {\n    content: '*';\n    display: inline-block;\n    color: #f56c6c;\n    margin-left: 4px;\n    vertical-align: top;\n}\n.attr-building .post-form .el-input {\n    width: 340px;\n}\n",""])},"25kv":function(e,t,n){var a=n("0DZ6");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("rjj0")("6cebf838",a,!0)},vG5j:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("cAgV"),i=n("R/UA"),l=n("oTRi"),o=n("TZKF"),s=n("2VPV"),r=n("VEpC"),c=n("QJuQ"),u=n("Zhbd"),d={name:"information-building",inject:["baseUrl"],directives:{waves:a.a},components:{"import-dialog":u.a},data:function(){return{downloading:!1,isImport:!1,isExport:!1,isRefreash:!1,multipleSelection:[],list:null,total:0,listLoading:!1,listQuery:{page:1,pageSize:10},campus:[],categories:[]}},methods:{getList:function(){var e=this;this.listLoading=!0,this.listQuery.page--,Object(i.r)(this.listQuery).then(function(t){e.listQuery.page++,e.listLoading=!1,t.data.status?(e.list=t.data.data.content,e.total=t.data.data.totalElements):e.$message({type:"warning",message:"机构信息列表获取失败"})})},getCampus:function(){var e=this;Object(c.a)().then(function(t){if(t.data.status){var n=t.data.data.content.filter(function(e){return e.zones.filter(function(e){return e.mapZoneByZoneId.is2D}).length>0});e.campus=n.map(function(e){return e.zones=e.zones.filter(function(e){return e.mapZoneByZoneId.is2D}),e})}})},handleSelectionChange:function(e){this.multipleSelection=e},handlerSearch:function(){this.listQuery.page=1,this.getList()},handleSizeChange:function(e){this.listQuery.pageSize=e,this.getList()},handleRefreash:function(){var e=this;this.isRefreash=!0,Object(s.a)({userId:window.cmips_userId}).then(function(t){e.isRefreash=!1,t.data.status?e.$notify({title:"成功",message:"大楼数据刷新成功",type:"success"}):e.$notify.error({title:"错误",message:"大楼信息刷新失败"})})},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()},handleDeletMany:function(){var e=this;this.multipleSelection.length>0?this.$confirm("此操作将永久删除选中的大楼, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i.c)(e.multipleSelection.map(function(e){return e.buildingCode}).join(",")).then(function(t){t.data.status?(e.$message({type:"success",message:"删除成功"}),e.getList()):e.$message({type:"error",message:"删除失败"})})}):this.$alert("请选择要删除的数据","消息提示",{confirmButtonText:"确定",type:"warning"})},downloadTemplate:function(){var e=this;this.downloading=!0,Object(o.a)().then(function(t){if(e.downloading=!1,t.data){var n=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8"}),a=window.URL.createObjectURL(n),i=document.createElement("a");i.style.display="none",i.href=a,i.setAttribute("download","大楼信息template-"+(new Date).toLocaleString()+".xlsx"),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(a)}})},handleImportExecel:function(){this.$refs.upload.openUpload()},handleExport:function(){var e=this;this.isExport=!0,Object(l.a)({userId:window.cmips_userId}).then(function(t){if(e.isExport=!1,t.data){var n=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8"}),a=window.URL.createObjectURL(n),i=document.createElement("a");i.style.display="none",i.href=a,i.setAttribute("download","大楼信息-"+(new Date).toLocaleString()+".xlsx"),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(a)}})},handleModifyStatus:function(e){var t=this;this.$confirm("此操作将永久删除该大楼, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i.h)(e).then(function(e){e.data.status?(t.$message({type:"success",message:"删除成功"}),t.getList()):t.$message({type:"error",message:"删除失败"})})})}},beforeMount:function(){var e=this;this.getList(),this.getCampus(),Object(r.J)().then(function(t){t.data.status?e.categories=t.data.data:e.$message({type:"error",message:"分类信息获取失败"})})}},p={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container attr-building"},[n("div",{staticClass:"filter-container"},[n("el-form",{ref:"form",attrs:{"label-position":"left",inline:!0}},[n("el-form-item",{attrs:{label:"校区:"}},[n("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.listQuery.campusCode,callback:function(t){e.$set(e.listQuery,"campusCode",t)},expression:"listQuery.campusCode"}},e._l(e.campus,function(e){return n("el-option",{key:e.groupId,attrs:{label:e.name,value:e.zones[e.zones.length-1].mapZoneByZoneId.id}})}))],1),e._v(" "),n("el-form-item",{attrs:{label:"大楼类别:"}},[n("el-select",{attrs:{clearable:"",placeholder:"请选择类别"},model:{value:e.listQuery.typeCode,callback:function(t){e.$set(e.listQuery,"typeCode",t)},expression:"listQuery.typeCode"}},e._l(e.categories,function(e){return n("el-option",{key:e.typeCode,attrs:{label:e.typeName,value:e.typeCode}})}))],1),e._v(" "),n("el-form-item",{attrs:{label:"大楼名称:"}},[n("el-input",{staticClass:"filter-item",model:{value:e.listQuery.buildingName,callback:function(t){e.$set(e.listQuery,"buildingName",t)},expression:"listQuery.buildingName"}})],1),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handlerSearch}},[e._v(e._s(e.$t("button.search")))]),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.handleDeletMany}},[e._v("批量删除")]),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticStyle:{"margin-left":"10px"},attrs:{type:"temp",icon:"el-icon-ips-shuju",loading:e.downloading},on:{click:e.downloadTemplate}},[e._v("下载导入模板")]),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"import",icon:"el-icon-ips-daoru",loading:e.isImport},on:{click:e.handleImportExecel}},[e._v("导入")]),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"export",icon:"el-icon-ips-daochu",loading:e.isExport},on:{click:e.handleExport}},[e._v("导出")])],1)],1),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.list,"element-loading-text":"加载中...",border:"",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),n("el-table-column",{attrs:{width:"100",label:e.$t("table.number"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.buildingCode))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"图片"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[n("img",{attrs:{src:t.row.mapBuildingImgList[0]?e.baseUrl+t.row.mapBuildingImgList[0].imgUrl:"",alt:"",width:"60"}})])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"大楼名称","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.buildingName))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"英文名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.enName))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"别名",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.alias))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"校区",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.campusName))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"大楼类别",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.mapBuildingType.typeName))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:e.$t("table.option"),"class-name":"small-padding fixed-width",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("router-link",{attrs:{to:{path:"/information-manager/createBuilding",query:{method:"update",id:t.row.buildingCode}}}},[n("el-button",{attrs:{type:"success",size:"mini"}},[e._v(e._s(e.$t("button.edit")))])],1),e._v(" "),n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(n){e.handleModifyStatus(t.row.buildingCode)}}},[e._v(e._s(e.$t("button.delete")))])]}}])})],1),e._v(" "),n("div",{staticClass:"pagination-container"},[n("el-pagination",{attrs:{background:"","current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),n("import-dialog",{ref:"upload",attrs:{uploadUrl:"/mapBuilding/upload",update:e.getList}})],1)},staticRenderFns:[]};var m=n("VU/8")(d,p,!1,function(e){n("25kv")},null,null);t.default=m.exports}});