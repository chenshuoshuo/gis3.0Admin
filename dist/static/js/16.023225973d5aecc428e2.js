webpackJsonp([16],{q3go:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("vLgD");var l={name:"tdlist",directives:{waves:i("cAgV").a},data:function(){return{tableKey:0,list:[],total:null,listLoading:!1,listQuery:{name:"",only_raster:!0,page:1,pageSize:10},rasterListQuery:{zone_id:"",page:0,page_size:100},rasterList:[],mapId:"",uploadText:{dbfFile:"未上传任何文件",shpFile:"未上传任何文件",shxFile:"未上传任何文件"},dialogFormVisible:!1,fileList:{}}},methods:{handlerSearch:function(){this.loadData()},loadData:function(){var e,t=this,i=this.$loading({text:"加载中"}),l=this.listQuery;l.page--,(e=l,Object(a.a)({url:"/map/v1/zone/page",method:"get",params:e})).then(function(e){i.close(),t.listQuery.page++,t.list=e.data.data.content,t.total=e.data.data.totalElements})},handleDbfFileFiles:function(e){this.fileList.dbfFile=document.getElementById("dbfFile").files[0],this.uploadText.dbfFile=document.getElementById("dbfFile").files[0].name},handleShpFileFiles:function(e){this.fileList.shpFile=document.getElementById("shpFile").files[0],this.uploadText.shpFile=document.getElementById("shpFile").files[0].name},handleShxFileFiles:function(e){this.fileList.shxFile=document.getElementById("shxFile").files[0],this.uploadText.shxFile=document.getElementById("shxFile").files[0].name},handleSureUpload:function(){var e=this,t=new FormData;t.append("mapId",this.mapId),t.append("dbfFile",this.fileList.dbfFile),t.append("shpFile",this.fileList.shpFile),t.append("shxFile",this.fileList.shxFile);var i,l=this.$loading();(i=t,Object(a.a)({url:"/map/v1/raster/upload",method:"post",data:i,headers:{"Content-Type":"multipart/form-data"}})).then(function(t){l.close(),0==t.data.code&&(e.mapId="",e.uploadText.dbfFile="上传文件",e.uploadText.shpFile="上传文件",e.uploadText.shxFile="上传文件",e.$alert("上传成功！","消息提示",{confirmButtonText:"确定"}).then(function(){e.dialogFormVisible=!1}))})},handlerDelete:function(e){var t=this;this.$confirm("此操作将永久删除"+e.name+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){fetchRasterDelete(e.id).then(function(e){0==e.data.code?(t.loadData(),t.$message({type:"success",message:"删除成功!"})):t.$message({type:"warning",message:"删除失败!"})})})},handleDeleteSingle:function(e){var t=this;this.$confirm("此操作将永久删除"+e.refName+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var i;(i=e.id,Object(a.a)({url:"/map/v1/raster/"+i,method:"delete"})).then(function(e){0==e.data.code?(t.loadData(),t.slotChange(t.rasterListQuery.zone_id),t.$message({type:"success",message:"删除成功!"})):t.$message({type:"warning",message:"删除失败!"})})})},slotChange:function(e){var t,i=this;this.rasterListQuery.zone_id=e,(t=this.rasterListQuery,Object(a.a)({url:"/map/v1/raster/",method:"get",params:t})).then(function(e){i.rasterList=e.data.data.content})}},mounted:function(){this.loadData()}},n={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-form",{ref:"form"},[i("el-form-item",{attrs:{label:"地图名称:"}},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"请输入"},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}}),e._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handlerSearch}},[e._v("搜索")]),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-upload2"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("上传\n          ")])],1)],1)],1),e._v(" "),e._l(e.list,function(t){return i("div",{on:{click:function(i){e.slotChange(t.id)}}},[i("el-collapse",{attrs:{accordion:""}},[i("el-collapse-item",{attrs:{title:t.name,name:t.id}},[i("template",{slot:"title"},[i("span",{staticClass:"zone-title"},[e._v("地区："+e._s(t.name))]),e._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"zone-delete-btn",attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(i){i.stopPropagation(),e.handlerDelete(t)}}},[e._v("删除\n\t          ")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.rasterList,"element-loading-text":"给我一点时间",border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),i("el-table-column",{attrs:{width:"",label:"名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.refName))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"110px",align:"center",label:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.id))])]}}])}),e._v(" "),i("el-table-column",{attrs:{width:"110px",align:"center",label:"zoneId"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.zoneId))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"200px","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(i){i.stopPropagation(),e.handleDeleteSingle(t.row)}}},[e._v("删除")])]}}])})],1)],2)],1)],1)}),e._v(" "),i("el-dialog",{attrs:{title:"批量导入",visible:e.dialogFormVisible,width:"440px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("div",{staticClass:"upload-input-box"},[i("label",{attrs:{for:""}},[e._v("mapId：")]),e._v(" "),i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.mapId,callback:function(t){e.mapId=t},expression:"mapId"}},e._l(e.list,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),i("div",{staticClass:"upload-input-box"},[i("label",{attrs:{for:""}},[e._v("上传dbfFile：")]),e._v(" "),i("div",{staticClass:"upload-input"},[i("input",{ref:"dbfFile",staticClass:"fileUpload",attrs:{type:"file",name:"fileDbfFile",id:"dbfFile"},on:{change:function(t){e.handleDbfFileFiles(t)}}}),e._v(" "),i("span",[e._v(e._s(e.uploadText.dbfFile))])])]),e._v(" "),i("div",{staticClass:"upload-input-box"},[i("label",{attrs:{for:""}},[e._v("上传shpFile：")]),e._v(" "),i("div",{staticClass:"upload-input"},[i("input",{ref:"shpFile",staticClass:"fileUpload",attrs:{type:"file",name:"fileShpFile",id:"shpFile"},on:{change:function(t){e.handleShpFileFiles(t)}}}),e._v(" "),i("span",[e._v(e._s(e.uploadText.shpFile))])])]),e._v(" "),i("div",{staticClass:"upload-input-box"},[i("label",{attrs:{for:""}},[e._v("上传shxFile：")]),e._v(" "),i("div",{staticClass:"upload-input"},[i("input",{ref:"shxFile",staticClass:"fileUpload",attrs:{type:"file",name:"fileShpFile",id:"shxFile"},on:{change:function(t){e.handleShxFileFiles(t)}}}),e._v(" "),i("span",[e._v(e._s(e.uploadText.shxFile))])])]),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleSureUpload}},[e._v("确 定")])],1)])],2)},staticRenderFns:[]};var s=i("VU/8")(l,n,!1,function(e){i("uaNV")},null,null);t.default=s.exports},uaNV:function(e,t,i){var a=i("vs9D");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("rjj0")("14ac768e",a,!0)},vs9D:function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,"\n.zone-title {\n  font-size: 18px;\n}\n.zone-delete-btn {\n  float: right;\n  margin: 6px 10px 0 0;\n}\n.upload-input-box {\n  overflow: hidden;\n  line-height: 32px;\n  margin-top: 8px;\n}\n.upload-input-box label {\n    float: left;\n    width: 100px;\n}\n.upload-input-box .upload-input {\n    float: left;\n    width: 200px;\n    height: 32px;\n    border: 1px solid #e5e5e5;\n    text-align: center;\n    cursor: pointer;\n    position: relative;\n    border-radius: 5px;\n}\n.upload-input-box .upload-input .fileUpload {\n      width: 100%;\n      height: 100%;\n      position: absolute;\n      top: 0;\n      left: 0;\n      opacity: 0;\n}\n",""])}});