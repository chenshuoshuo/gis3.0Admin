webpackJsonp([4],{maxi:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o("Zv1W"),l={name:"addZone",data:function(){var t=function(t,e,o){e?/^\d+(\.\d+)?$/.test(e)||/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/.test(e)?e>25||e<0?o(new Error("请输入0-25之间的数字")):o():o(new Error("地图等级必须为数字！")):o(new Error("请输入正确的地图等级"))},e=function(t,e,o){e?/^\d+(\.\d+)?$/.test(e)||/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/.test(e)?e>180||e<-180?o(new Error("请输入-180-180之间的数字")):o():o(new Error("经度值必须为数字！")):o(new Error("请输入正确的经度值"))},o=function(t,e,o){e?/^\d+(\.\d+)?$/.test(e)||/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/.test(e)?e>90||e<-90?o(new Error("请输入-90-90之间的数字")):o():o(new Error("纬度值必须为数字！")):o(new Error("请输入正确的纬度值"))};return{submitLoading:!1,ruleForm:{name:"",style_id:"",default_zoom:"",min_zoom:"",max_zoom:"",bbox:"",bboxLeftBottomLon:"",bboxLeftBottomLat:"",bboxRightTopLon:"",bboxRightTopLat:"",center:"",center_lon:"",center_lat:"",id:"",icon:""},rules:{name:[{validator:function(t,e,o){e?/[，\s_'’‘\"”“|\\~#$@%^&*!。;\/<>\?？]/.test(e)?o(new Error("地图名称不能包含特殊字符")):o():o(new Error("请输入地图名称"))},trigger:"blur"}],style_id:[{required:!0,message:"请选择地图样式",trigger:"change"}],default_zoom:[{validator:t,trigger:"blur"}],min_zoom:[{validator:t,trigger:"blur"}],max_zoom:[{validator:t,trigger:"blur"}],bboxLeftBottomLon:[{validator:e,trigger:"blur"}],bboxLeftBottomLat:[{validator:o,trigger:"blur"}],bboxRightTopLon:[{validator:e,trigger:"blur"}],bboxRightTopLat:[{validator:o,trigger:"blur"}],center_lon:[{validator:e,trigger:"blur"}],center_lat:[{validator:o,trigger:"blur"}]}}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){t&&(e.ruleForm.id?e.updateZone():e.creatZone())})},upload:function(t){var e=this,o=t.file,l=new FormData;l.append("iconFile",o),Object(r.j)(l).then(function(t){0===t.data.code&&(e.ruleForm.icon=t.data.data.url,e.$forceUpdate())})},resetForm:function(t){this.ruleForm={},this.$refs.ruleForm.resetFields()},creatZone:function(){var t=this;this.submitLoading=!0,this.ruleForm.bbox=this.ruleForm.bboxLeftBottomLon+","+this.ruleForm.bboxLeftBottomLat+","+this.ruleForm.bboxRightTopLon+","+this.ruleForm.bboxLeftBottomLat,this.ruleForm.center=this.ruleForm.center_lon+","+this.ruleForm.center_lat,Object(r.b)(this.ruleForm).then(function(e){t.submitLoading=!1,0===e.data.code&&t.$alert("区域创建成功！","消息提示",{confirmButtonText:"确定"}).then(function(){t.resetForm("ruleForm"),t.$router.push({path:"/zoneManger/page"})})})},updateZone:function(){var t=this;this.submitLoading=!0,this.ruleForm.bbox=this.ruleForm.bboxLeftBottomLon+","+this.ruleForm.bboxLeftBottomLat+","+this.ruleForm.bboxRightTopLon+","+this.ruleForm.bboxLeftBottomLat,this.ruleForm.center=this.ruleForm.center_lon+","+this.ruleForm.center_lat,Object(r.f)(this.ruleForm).then(function(e){t.submitLoading=!1,0===e.data.code&&t.$alert("区域更新成功！","消息提示",{confirmButtonText:"确定",callback:function(){t.resetForm("ruleForm"),t.$router.push({path:"/zoneManger/page"})}})})}},mounted:function(){var t=this;this.$route.params.id&&Object(r.g)(this.$route.params.id).then(function(e){var o=e.data.data.bbox.split(","),r=e.data.data.center.split(",");t.ruleForm.bboxLeftBottomLon=o[0],t.ruleForm.bboxLeftBottomLat=o[1],t.ruleForm.bboxRightTopLon=o[2],t.ruleForm.bboxRightTopLat=o[3],t.ruleForm.center_lon=r[0],t.ruleForm.center_lat=r[1],t.ruleForm.default_zoom=e.data.data.default_zoom,t.ruleForm.min_zoom=e.data.data.min_zoom,t.ruleForm.max_zoom=e.data.data.max_zoom,t.ruleForm.icon=e.data.data.icon,t.ruleForm.is_2d=e.data.data.is_2d?1:0,t.ruleForm.style_id=e.data.data.style_id,t.ruleForm.name=e.data.data.name,t.ruleForm.id=e.data.data.id})}},a={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"addZone"},[o("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{"padding-right":"20px"},attrs:{model:t.ruleForm,rules:t.rules,"label-width":"120px"}},[o("el-row",{attrs:{gutter:10}},[o("el-col",{attrs:{md:5,sm:8}},[o("el-form-item",{attrs:{label:"是否是二维:",prop:"is_2d"}},[o("el-select",{attrs:{placeholder:"请选择地图类型"},model:{value:t.ruleForm.is_2d,callback:function(e){t.$set(t.ruleForm,"is_2d",e)},expression:"ruleForm.is_2d"}},[o("el-option",{attrs:{label:"是",value:1}}),t._v(" "),o("el-option",{attrs:{label:"否",value:0}})],1)],1)],1),t._v(" "),o("el-col",{attrs:{md:5,sm:8}},[o("el-form-item",{attrs:{label:"地图名称:",prop:"name"}},[o("el-input",{attrs:{placeholder:"地图名称"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1)],1),t._v(" "),o("el-col",{attrs:{md:5,sm:8}},[o("el-form-item",{attrs:{label:"地图样式:",prop:"style_id"}},[o("el-select",{attrs:{placeholder:"请选择地图样式"},model:{value:t.ruleForm.style_id,callback:function(e){t.$set(t.ruleForm,"style_id",e)},expression:"ruleForm.style_id"}},[o("el-option",{attrs:{label:"样式一",value:"1"}}),t._v(" "),o("el-option",{attrs:{label:"样式二",value:"3"}})],1)],1)],1)],1),t._v(" "),o("el-row",{attrs:{gutter:10}},[o("el-col",{attrs:{md:5,sm:8}},[o("el-form-item",{attrs:{label:"默认地图等级:",prop:"default_zoom"}},[o("el-input",{attrs:{placeholder:"默认地图等级",type:"number"},model:{value:t.ruleForm.default_zoom,callback:function(e){t.$set(t.ruleForm,"default_zoom",e)},expression:"ruleForm.default_zoom"}})],1)],1),t._v(" "),o("el-col",{attrs:{md:5}},[o("el-form-item",{attrs:{label:"最小等级:",prop:"min_zoom"}},[o("el-input",{attrs:{placeholder:"最小等级",type:"number"},model:{value:t.ruleForm.min_zoom,callback:function(e){t.$set(t.ruleForm,"min_zoom",e)},expression:"ruleForm.min_zoom"}})],1)],1),t._v(" "),o("el-col",{attrs:{md:5,sm:8}},[o("el-form-item",{attrs:{label:"最大等级:",prop:"max_zoom"}},[o("el-input",{attrs:{placeholder:"最大等级",type:"number"},model:{value:t.ruleForm.max_zoom,callback:function(e){t.$set(t.ruleForm,"max_zoom",e)},expression:"ruleForm.max_zoom"}})],1)],1)],1),t._v(" "),o("el-row",{attrs:{gutter:2}},[o("el-col",{attrs:{md:5,sm:8}},[o("el-form-item",{attrs:{label:"包围盒子:",prop:"bboxLeftBottomLon"}},[o("el-input",{attrs:{placeholder:"左下角经度",type:"number"},model:{value:t.ruleForm.bboxLeftBottomLon,callback:function(e){t.$set(t.ruleForm,"bboxLeftBottomLon",e)},expression:"ruleForm.bboxLeftBottomLon"}})],1)],1),t._v(" "),o("el-col",{attrs:{md:5,sm:8}},[o("el-form-item",{attrs:{prop:"bboxLeftBottomLat"}},[o("el-input",{attrs:{placeholder:"左下角纬度",type:"number"},model:{value:t.ruleForm.bboxLeftBottomLat,callback:function(e){t.$set(t.ruleForm,"bboxLeftBottomLat",e)},expression:"ruleForm.bboxLeftBottomLat"}})],1)],1),t._v(" "),o("el-col",{attrs:{md:5,sm:8}},[o("el-form-item",{attrs:{prop:"bboxRightTopLon"}},[o("el-input",{attrs:{placeholder:"右上角经度",type:"number"},model:{value:t.ruleForm.bboxRightTopLon,callback:function(e){t.$set(t.ruleForm,"bboxRightTopLon",e)},expression:"ruleForm.bboxRightTopLon"}})],1)],1),t._v(" "),o("el-col",{attrs:{md:5,sm:8}},[o("el-form-item",{attrs:{prop:"bboxRightTopLat"}},[o("el-input",{attrs:{placeholder:"右上角纬度",type:"number"},model:{value:t.ruleForm.bboxRightTopLat,callback:function(e){t.$set(t.ruleForm,"bboxRightTopLat",e)},expression:"ruleForm.bboxRightTopLat"}})],1)],1)],1),t._v(" "),o("el-row",{attrs:{gutter:2}},[o("el-col",{attrs:{md:5,sm:10}},[o("el-form-item",{attrs:{label:"地图中心点:",prop:"center_lon"}},[o("el-input",{attrs:{placeholder:"中心点经度",type:"number"},model:{value:t.ruleForm.center_lon,callback:function(e){t.$set(t.ruleForm,"center_lon",e)},expression:"ruleForm.center_lon"}})],1)],1),t._v(" "),o("el-col",{attrs:{md:5,sm:10}},[o("el-form-item",{attrs:{prop:"center_lat"}},[o("el-input",{attrs:{placeholder:"中心点纬度",type:"number"},model:{value:t.ruleForm.center_lat,callback:function(e){t.$set(t.ruleForm,"center_lat",e)},expression:"ruleForm.center_lat"}})],1)],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"地图ICON:",prop:"icon"}},[o("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","http-request":t.upload,"show-file-list":!1}},[t.ruleForm.icon?o("img",{staticClass:"avatar",attrs:{src:"https://gis.you07.com/"+t.ruleForm.icon}}):o("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),t._v(" "),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("建议尺寸88 x 88(px)")])])],1),t._v(" "),o("el-form-item",[o("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.submitLoading,expression:"submitLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary",size:"medium"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("提交")]),t._v(" "),o("el-button",{attrs:{size:"medium"},on:{click:function(e){t.resetForm("ruleForm")}}},[t._v("重置")])],1)],1)],1)},staticRenderFns:[]};var n=o("VU/8")(l,a,!1,function(t){o("pbcs")},null,null);e.default=n.exports},pbcs:function(t,e,o){var r=o("qgPO");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);o("rjj0")("435c974f",r,!0)},qgPO:function(t,e,o){(t.exports=o("FZ+f")(!1)).push([t.i,"\n.addZone {\n  margin-top: 20px;\n}\n.addZone .avatar-uploader .el-upload {\n    border: 1px dashed #d9d9d9;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n}\n.addZone .avatar-uploader .el-upload:hover {\n    border-color: #409EFF;\n}\n.addZone .avatar-uploader-icon {\n    font-size: 28px;\n    color: #8c939d;\n    width: 178px;\n    height: 178px;\n    line-height: 178px;\n    text-align: center;\n}\n.addZone .avatar {\n    width: 178px;\n    height: 178px;\n    display: block;\n}\n",""])}});